"use strict";var d=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var W=d(_=>{"use strict";var Ee=_&&_.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,o)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),De=_&&_.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),Re=_&&_.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.prototype.hasOwnProperty.call(i,t)&&Ee(e,i,t);return De(e,i),e},Te=_&&_.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(_,"__esModule",{value:!0});_.app=_.startService=void 0;var ue=Te(require("express")),Ie=Re(require("path")),ae=(0,ue.default)();ae.use("/assets",ue.default.static(Ie.join(process.cwd(),"/dist/assets")));var ce=process.env.PORT||3e3;function Fe(){_.app.listen(ce,()=>{console.log("Service started"),console.log(`http://localhost:${ce}`)})}_.startService=Fe;_.app=ae});var Y=d(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.getAuthor=void 0;function He(){return{author:{name:"Jorge Luis",lastname:"Caviedes"}}}I.getAuthor=He});var de=d(h=>{"use strict";var Ae=h&&h.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,o)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),se=h&&h.__exportStar||function(i,e){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ae(e,i,t)};Object.defineProperty(h,"__esModule",{value:!0});se(W(),h);se(Y(),h)});var _e=d(m=>{"use strict";var le=m&&m.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(m,"__esModule",{value:!0});m.ProductApplication=void 0;var fe=Y(),x=class{constructor(e){this._repository=e}searchProducts(e){return le(this,void 0,void 0,function*(){let t=yield this._repository.searchProducts(e),r=this.rankingCategory(t),o=yield this._repository.categoriesById(r.value);return Object.assign(Object.assign({},(0,fe.getAuthor)()),{categories:o,items:t})})}detailProductById(e){return le(this,void 0,void 0,function*(){let t=yield this._repository.detailProductById(e),r=yield this._repository.categoriesById(t.categoryId);return Object.assign(Object.assign({},(0,fe.getAuthor)()),{item:t,categories:r})})}rankingCategory(e){let t={};e.forEach(o=>{let c=o.categoryId;t[c]=(t[c]||0)+1});let r={value:"",count:0};return Object.keys(t).forEach(o=>{t[o]>r.count&&(r={value:o,count:t[o]})}),r}};m.ProductApplication=x});var pe=d(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.breadcrumb=void 0;var $e=require("vue");function Ne(i){return(0,$e.createSSRApp)({data:()=>({points:i}),template:`
        <div class="breadcrumb-items">
            <div v-for="point in points" :key="point" class="breadcrumb-item" >
                {{point}}
            </div>
        </div>
      `})}F.breadcrumb=Ne});var H=d(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.convertNormalizedText=b.formatCurrecy=void 0;function Ue(i){let e={style:"currency",currency:"USD",maximumSignificantDigits:3};return new Intl.NumberFormat("en-US",e).format(i)}b.formatCurrecy=Ue;function ze(i){let e=i.toLowerCase();return e=e.replace(new RegExp("\\s","g"),""),e=e.replace(new RegExp("[\xE0\xE1\xE2\xE3\xE4\xE5]","g"),"a"),e=e.replace(new RegExp("\xE6","g"),"ae"),e=e.replace(new RegExp("\xE7","g"),"c"),e=e.replace(new RegExp("[\xE8\xE9\xEA\xEB]","g"),"e"),e=e.replace(new RegExp("[\xEC\xED\xEE\xEF]","g"),"i"),e=e.replace(new RegExp("\xF1","g"),"n"),e=e.replace(new RegExp("[\xF2\xF3\xF4\xF5\xF6]","g"),"o"),e=e.replace(new RegExp("\u0153","g"),"oe"),e=e.replace(new RegExp("[\xF9\xFA\xFB\xFC]","g"),"u"),e=e.replace(new RegExp("[\xFD\xFF]","g"),"y"),e=e.replace(new RegExp("\\W","g"),""),e}b.convertNormalizedText=ze});var ve=d(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.detailProduct=void 0;var Le=require("vue"),Xe=H();function Je(i){return(0,Le.createSSRApp)({methods:{currency(e){return(0,Xe.formatCurrecy)(Number(e))}},data:()=>({data:i}),template:`
        <div class="detail-item">
            <div class="detail-item_column1">
                <img :src="data.piture" alt="" class="detail-item_img" />
                <h1>Descripcion del producto</h1>
                <p class="text-color-light-gray detail-item_description">
                    {{data.description}}
                </p>
            </div>
            <div class="detail-item_column2">
                <span>{{data.condition === "new"? "Nuevo":"Usado"}}</span> 
                <h2>{{data.title}}</h2>            
                <div class="detail-item_price">
                    <h1> {{ currency(data.price.currency) }} 
                        <h2 class="detail-item_decimal"> {{ String(data.price.decimals||0).padEnd(2,'0') }} </h2>
                    </h1>                   
                </div>
                <button class="button-primary">Comprar</button>
            </div>
        </div>
      `})}A.detailProduct=Je});var he=d($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.listProducts=void 0;var We=require("vue"),Ye=H();function xe(i=[]){return(0,We.createSSRApp)({methods:{currency(e){return(0,Ye.formatCurrecy)(Number(e))}},data:()=>({items:i}),template:`
    <div class="list-items">
      <div v-for="item in items" :key="item.id" >
        <a :href="'/items/' + item.id" class="list-item">
          <img :src="item.piture" alt="" class="list-item-image"/>
          <div class="list-item_detail">
            <h3 class="list-item_price"> {{ currency(item.price.currency) }}</h3>
            <article class="list-item_title" >{{item.title}}</article>
          </div> 
          <span class="list-item_free-shipping">{{item.free_shipping? "Env\xEDo gratis": ""}}</span>
        </a>
      </div>
    </div>
    `})}$.listProducts=xe});var ye=d(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.searchComponent=void 0;var Ge=require("vue");function Ke(i){return(0,Ge.createSSRApp)({data(){return{value:i}},template:`
        <div class="box-search">
        <form action="/items?" method="get" role="search" class="wraper box-search_form">
          <img src="/assets/imgs/logo__large_plus.png" alt="logo" class="box-search_logo" />
          <div class="box-search_container">
            <input class="box-search_input"
              :value="value"
              type="search" name="search" placeholder="Nunca dejes de buscar" />
            <button class="box-search_glass_searh" type='submit'>
              <div class="box-search_glass">
              </div>
              search
            </button>
          </div>
        </form>
      </div>
        `})}N.searchComponent=Ke});var T=d(v=>{"use strict";var Qe=v&&v.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,o)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),U=v&&v.__exportStar||function(i,e){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Qe(e,i,t)};Object.defineProperty(v,"__esModule",{value:!0});U(pe(),v);U(ve(),v);U(he(),v);U(ye(),v)});var O=d(g=>{"use strict";var Ze=g&&g.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(g,"__esModule",{value:!0});g.containerView=void 0;function ke(i){return Ze(this,void 0,void 0,function*(){return`
      <!DOCTYPE html>
      <html lang="es">
      <html>
        <head>
          <meta charset="UTF-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Mercado Libre</title>
          <link rel="stylesheet" href="/assets/styles/global.css">
          <script type="importmap">
          {
            "imports": {
              "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"
            }
          }
        <\/script>
        </head>
        <body>
          <div id="app" class="body-background">
              ${i}
          </div>
        </body>
      </html>
      `})}g.containerView=ke});var we=d(P=>{"use strict";var et=P&&P.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(P,"__esModule",{value:!0});P.searchEmptyView=void 0;var tt=require("vue/server-renderer"),it=T(),rt=O();function nt(){return et(this,void 0,void 0,function*(){let i=(0,it.searchComponent)(""),e=yield(0,tt.renderToString)(i);return(0,rt.containerView)(`${e}`)})}P.searchEmptyView=nt});var Q=d(j=>{"use strict";var ot=j&&j.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(j,"__esModule",{value:!0});j.resultView=void 0;var G=require("vue/server-renderer"),K=T(),ct=O();function ut(i){return ot(this,void 0,void 0,function*(){let e=(0,K.searchComponent)(i.search),t=yield(0,G.renderToString)(e),r=(0,K.listProducts)(i.items),o=yield(0,G.renderToString)(r),c=(0,K.breadcrumb)(i.categories),u=yield(0,G.renderToString)(c);return(0,ct.containerView)(`       
        ${t}
        <div class="wraper">${u}</div>
        <div class="wraper">${o}</div> 
      `)})}j.resultView=ut});var Z=d(q=>{"use strict";var at=q&&q.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(q,"__esModule",{value:!0});q.notFoundView=void 0;var st=O();function dt(){return at(this,void 0,void 0,function*(){return(0,st.containerView)(`
        <div class="not-found">
            <h1 class="not-found_404">404</h1>
            <form action="/" method="get">
                <button class="not-found_reset">Volver Home</button>
            </form>
        </div>
    `)})}q.notFoundView=dt});var te=d(M=>{"use strict";var lt=M&&M.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(M,"__esModule",{value:!0});M.detailView=void 0;var k=require("vue/server-renderer"),ee=T(),ft=O();function _t(i){return lt(this,void 0,void 0,function*(){let e=(0,ee.searchComponent)(""),t=yield(0,k.renderToString)(e),r=yield(0,ee.detailProduct)(i.item),o=yield(0,k.renderToString)(r),c=(0,ee.breadcrumb)(i.categories),u=yield(0,k.renderToString)(c);return(0,ft.containerView)(`       
      ${t}
      <div class="wraper">${u}</div>
      <div class="wraper">${o}</div> 
    `)})}M.detailView=_t});var me=d(p=>{"use strict";var pt=p&&p.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,o)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),V=p&&p.__exportStar||function(i,e){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pt(e,i,t)};Object.defineProperty(p,"__esModule",{value:!0});V(we(),p);V(Q(),p);V(Z(),p);V(te(),p);V(O(),p);V(T(),p)});var be=d(S=>{"use strict";var z=S&&S.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(S,"__esModule",{value:!0});S.ProductVueView=void 0;var vt=me(),ht=te(),yt=Z(),wt=Q(),ie=class{startView(){return z(this,void 0,void 0,function*(){return(0,vt.searchEmptyView)()})}searchProductsView(e){return z(this,void 0,void 0,function*(){return(0,wt.resultView)(e)})}detailProductView(e){return z(this,void 0,void 0,function*(){return(0,ht.detailView)(e)})}notFound404View(){return z(this,void 0,void 0,function*(){return(0,yt.notFoundView)()})}};S.ProductVueView=ie});var Oe=d(y=>{"use strict";var mt=y&&y.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,o)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),ge=y&&y.__exportStar||function(i,e){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&mt(e,i,t)};Object.defineProperty(y,"__esModule",{value:!0});ge(_e(),y);ge(be(),y)});var Pe=d(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.itemApiToItemMap=void 0;function bt(i){var e;let t=(i.prices||[{}])[0]||{};return{id:i.id,condition:i.condition,categoryId:i.category_id,description:"",free_shipping:((e=i==null?void 0:i.shipping)===null||e===void 0?void 0:e.free_shipping)||!1,piture:i.thumbnail,price:{amount:t.amount,decimals:0,currency:(i.price||0).toString()},sold_quantity:-1,title:i.title}}L.itemApiToItemMap=bt});var qe=d(w=>{"use strict";var re=w&&w.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})},gt=w&&w.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(w,"__esModule",{value:!0});w.ProductApiRepository=void 0;var X=gt(require("axios")),Ot=H(),je=Pe(),ne=class{constructor(){this.MAX_PRODUCTS=4}categoriesById(e){var t;return re(this,void 0,void 0,function*(){return(((t=(yield X.default.get(`https://api.mercadolibre.com/categories/${e}`)).data)===null||t===void 0?void 0:t.path_from_root)||[]).map(c=>c.name)})}searchProducts(e){var t;return re(this,void 0,void 0,function*(){let r=(0,Ot.convertNormalizedText)(e);return(((t=(yield X.default.get(`https://api.mercadolibre.com/sites/MLA/search?q=${r}`)).data)===null||t===void 0?void 0:t.results)||[]).slice(0,this.MAX_PRODUCTS).map(je.itemApiToItemMap)})}detailProductById(e){return re(this,void 0,void 0,function*(){let t=yield X.default.get(`https://api.mercadolibre.com/items/${e}`),r=yield X.default.get(`https://api.mercadolibre.com/items/${e}/description`),o=t.data||{},c=(0,je.itemApiToItemMap)(o);return c.description=r.data.plain_text,c})}};w.ProductApiRepository=ne});var Ve=d(B=>{"use strict";var C=B&&B.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(B,"__esModule",{value:!0});B.ProductController=void 0;var Me=Oe(),Pt=qe(),oe=class{constructor(){this._app=new Me.ProductApplication(new Pt.ProductApiRepository),this._view=new Me.ProductVueView}searchProductsView(e){return C(this,void 0,void 0,function*(){let t="";try{let r=yield this.searchProducts(e);t=yield this._view.searchProductsView(Object.assign(Object.assign({},r),{search:e}))}catch(r){t=yield this._view.notFound404View()}return t})}detailProductView(e){return C(this,void 0,void 0,function*(){let t="";try{let r=yield this.detailProductById(e);t=yield this._view.detailProductView(Object.assign({},r))}catch(r){t=yield this._view.notFound404View()}return t})}notFound404View(){return C(this,void 0,void 0,function*(){return yield this._view.notFound404View()})}startView(){return C(this,void 0,void 0,function*(){return yield this._view.startView()})}searchProducts(e){return C(this,void 0,void 0,function*(){return yield this._app.searchProducts(e)})}detailProductById(e){return C(this,void 0,void 0,function*(){return yield this._app.detailProductById(e)})}};B.ProductController=oe});var Se=d(J=>{"use strict";var E=J&&J.__awaiter||function(i,e,t,r){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(n){try{a(r.next(n))}catch(s){u(s)}}function f(n){try{a(r.throw(n))}catch(s){u(s)}}function a(n){n.done?c(n.value):o(n.value).then(l,f)}a((r=r.apply(i,e||[])).next())})};Object.defineProperty(J,"__esModule",{value:!0});var D=de(),R=Ve();D.app.get("/",(i,e)=>E(void 0,void 0,void 0,function*(){let t=yield new R.ProductController().startView();e.send(t)}));D.app.get("api/items?",(i,e)=>E(void 0,void 0,void 0,function*(){let{search:t}=i.query||{},r=yield new R.ProductController().searchProducts(t);e.json(r)}));D.app.get("api/items/:id",(i,e)=>E(void 0,void 0,void 0,function*(){let{id:t}=i.params||{},r=yield new R.ProductController().detailProductById(t);e.json(r)}));D.app.get("/items?",(i,e)=>E(void 0,void 0,void 0,function*(){let{search:t}=i.query||{},r=yield new R.ProductController().searchProductsView(t);e.send(r)}));D.app.get("/items/:id",(i,e)=>E(void 0,void 0,void 0,function*(){let{id:t}=i.params||{},r=yield new R.ProductController().detailProductView(t);e.send(r)}));D.app.get("/*",(i,e)=>E(void 0,void 0,void 0,function*(){let t=yield new R.ProductController().notFound404View();e.send(t)}))});var Be=d(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Se()});var jt=exports&&exports.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,r,o)}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),qt=exports&&exports.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),Mt=exports&&exports.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.prototype.hasOwnProperty.call(i,t)&&jt(e,i,t);return qt(e,i),e};Object.defineProperty(exports,"__esModule",{value:!0});var Vt=Mt(W());Be();Vt.startService();
